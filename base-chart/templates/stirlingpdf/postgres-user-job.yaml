{{- if .Values.apps.stirlingpdf.enabled -}}
apiVersion: batch/v1
kind: Job
metadata:
  name: stirlingpdf-pipeline-job
  namespace: argocd
spec:
  template:
    spec:
      volumes:
        - name: scanner
          persistentVolumeClaim:
            claimName: stirlingpdf-scanner-pvc
      containers:
        - name: stirlingpdf-pipeline-job
          image: "busybox:latest"
#           envFrom:
#             - secretRef:
#                 name: postgres-secret
#             - secretRef:
#                 name: paperlessngx-secret
#             - configMapRef:
#                 name: postgres-config
          command: ["sh", "-c"]
          volumeMounts:
          - name: scanner
            mountPath: /pipeline/watchedFolders/scanner
          args:
            - |
              set -e
              echo "Starting stirlingpdf-pipeline-job..."
              echo "HELLO" >  /pipeline/watchedFolders/scanner/hello.txt

      restartPolicy: OnFailure
{{- end -}}
