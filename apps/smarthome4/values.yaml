generic:
  appName: smarthome4
  configMaps:
    smarthome4-config-map:
      SPRING_PROFILES_ACTIVE: "prod"
      MQTT_BROKER_HOST: "mosquitto-service"
      MQTT_BROKER_PORT: "1883"
      HOMEASSISTANT_BASEURL: "http://homeassistant-service:8123"
      HOMEASSISTANT_CACHE_MAXAGEMS: "300000"
      SMARTHOME_CONFIG_PATH: "/config/smarthome-config.yaml"
      DEVICE_STATE_TIMEOUT_SECONDS: "300"
      APPLICATION_MODEL_REFRESH_ENABLED: "true"
      APPLICATION_MODEL_REFRESH_INTERVAL_MS: "300000"
      APPLICATION_MODEL_REFRESH_INITIAL_DELAY_MS: "60000"
  externalSecrets:
    smarthome4-secret:
      - HOMEASSISTANT_APITOKEN: "/smarthome4/HOMEASSISTANT_APITOKEN"
      - MQTT_BROKER_USERNAME: "/smarthome4/MQTT_BROKER_USERNAME"
      - MQTT_BROKER_PASSWORD: "/smarthome4/MQTT_BROKER_PASSWORD"
  deployment:
    image: 629099703604.dkr.ecr.eu-central-1.amazonaws.com/hess.pm/smarthome4:v0.0.14
    ports:
    - containerPort: 8080
    envFrom:
      configMapRef: smarthome4-config-map
      secretRef: smarthome4-secret
    configMapMounts:
      config:
        mountPath: /config
        configMapName: smarthome4-app-config
    livenessProbe:
      httpGet:
        path: /actuator/health
        port: 8080
      initialDelaySeconds: 60
      periodSeconds: 30
      timeoutSeconds: 10
    readinessProbe:
      httpGet:
        path: /actuator/health
        port: 8080
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 10
    resources:
      requests:
        memory: "256Mi"
        cpu: "100m"
      limits:
        memory: "512Mi"
        cpu: "500m"
    imagePullSecrets:
    - regcred-primary
  service:
    ports:
    - name: http
      port: 8080

# External configuration chart (deployed as separate ArgoCD Application)
externalConfig:
  repoURL: ""
  targetRevision: "main"
  path: ""
  configMapName: "smarthome4-app-config"
